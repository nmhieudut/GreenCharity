import {
  Box,
  Button,
  Flex,
  Grid,
  Heading,
  Stack,
  Text,
  useColorModeValue
} from "@chakra-ui/react";
import Head from "next/head";
import { useRouter } from "next/router";
import CountUp from "react-countup";
import { FcConferenceCall, FcDonate } from "react-icons/fc";
import { useSelector } from "react-redux";
import SectionContainer from "src/components/common/SectionContainer";
import CampaignCard from "src/components/uncommon/CampaignCard";
import { color } from "src/constants/color";
import { CampaignService } from "src/services/campaign";
import { wrapper } from "src/store";

export const getServerSideProps = async ctx => {
  const { res } = ctx;
  try {
    const data = await CampaignService.fetchCampaigns();
    return {
      props: {
        campaigns: data.campaigns
      }
    };
  } catch (e) {
    res.writeHead(301, {
      Location: "/404"
    });
    res.end();
    return {
      props: {
        data: []
      }
    };
  }
};

export default function Home({ campaigns }) {
  const state = useSelector(state => state.auth);
  const router = useRouter();
  const directToDetailPage = id => {
    router.push(`/campaigns/${id}`);
  };
  console.log("state", state);
  return (
    <div>
      <Head>
        <title>Green Charity - Trang chuÌ‰</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/images/thumbnail.png" />
      </Head>
      <SectionContainer minH="100vh">
        <Stack
          h="scree"
          textAlign={"center"}
          align={"center"}
          spacing={{ base: 4, md: 8 }}
          py={{ base: 8, md: 14 }}
        >
          <Heading
            color={color.PRIMARY}
            fontSize={{ base: "3xl", sm: "4xl", md: "5xl" }}
          >
            QuyÌƒ tÆ°Ì€ thiÃªÌ£n{" "}
            <Text as={"span"} color={"green.400"}>
              Green
            </Text>
            <Text as={"span"} color={color.PRIMARY}>
              Charity
            </Text>
          </Heading>
          <Text fontSize={"lg"}>
            GreenCharity lÃ  ná»n táº£ng giÃºp báº¡n dá»… dÃ ng chung tay quyÃªn gÃ³p tiá»n
            cÃ¹ng hÃ ng triá»‡u ngÆ°á»i, giÃºp Ä‘á»¡ cÃ¡c hoÃ n cáº£nh khÃ³ khÄƒn trÃªn kháº¯p cáº£
            nÆ°á»›c.
          </Text>
          <Grid
            templateColumns={[
              "repeat(1, 1fr)",
              "repeat(2, 1fr)",
              "repeat(3, 1fr)"
            ]}
            gap={8}
          >
            <Box>
              <Text fontSize={"2xl"} color={color.PRIMARY} fontWeight={600}>
                <CountUp end={30} duration={3} />
              </Text>
              <Text>HoaÌ£t Ä‘Ã´Ì£ng thaÌ€nh cÃ´ng</Text>
            </Box>
            <Box>
              <Text fontSize={"2xl"} color={color.PRIMARY} fontWeight={600}>
                <CountUp separator="," end={40000} duration={3} />
              </Text>
              <Text>LÆ°Æ¡Ì£t quyÃªn goÌp</Text>
            </Box>
            <Box>
              <Text fontSize={"2xl"} color={color.PRIMARY} fontWeight={600}>
                <CountUp separator="," end={1435600000} duration={3} />
              </Text>
              <Text>ÄÃ´Ì€ng Ä‘Æ°Æ¡Ì£c quyÃªn goÌp</Text>
            </Box>
          </Grid>
          <Stack spacing={6} direction={["column", "row"]}>
            <a href="/#current-campaigns">
              <Button
                size="lg"
                rounded={"full"}
                px={6}
                colorScheme={"purple"}
                bg={color.PRIMARY}
              >
                TiÌ€m hiÃªÌ‰u
              </Button>
            </a>

            <a href="/#get-started">
              <Button
                size="lg"
                colorScheme={"purple"}
                rounded={"full"}
                px={6}
                variant="outline"
              >
                BÄƒÌt Ä‘Ã¢Ì€u ngay
              </Button>
            </a>
          </Stack>
          <Flex w={"full"} justify={"center"}>
            <img src="/images/hero.png" alt="hero" width="60%" />
          </Flex>
        </Stack>
      </SectionContainer>
      <SectionContainer id="get-started" hasBg>
        <Heading
          textAlign="center"
          fontSize={{ base: "3xl", sm: "4xl", md: "5xl" }}
          lineHeight={"110%"}
          color={color.PRIMARY}
        >
          TiÌch Ä‘Æ°Ìc khÃ´ng khoÌ, laÌ€m viÃªÌ£c tÃ´Ìt thiÌ€ caÌ€ng dÃªÌƒ hÆ¡n
        </Heading>

        <Grid
          my={12}
          mx="auto"
          maxW={"4xl"}
          templateColumns={[
            "repeat(1, 1fr)",
            "repeat(1, 1fr)",
            "repeat(2, 1fr)"
          ]}
        >
          <Flex
            direction="column"
            className="border-2"
            bg={useColorModeValue("white", "gray.800")}
            boxShadow={"2xl"}
            rounded={"md"}
            overflow={"hidden"}
            m={4}
          >
            <Box
              p={6}
              color={useColorModeValue("gray.800", "white")}
              align={"center"}
              flex={1}
            >
              <FcConferenceCall size="3rem" />
              <Text py={4} fontWeight={600} fontSize={"xl"}>
                TÃ”I MUÃ”ÌN THÃ”NG TIN TÆ ÌI CAÌC NHAÌ€ HAÌ‰O TÃ‚M
              </Text>
            </Box>
            <Box px={6} pb={6} pt={"auto"}>
              <Text>
                BaÌ£n gÄƒÌ£p vaÌ€i hoaÌ€n caÌ‰nh khoÌ khÄƒn maÌ€ khÃ´ng thÃªÌ‰ kÃªu goÌ£i. HaÌƒy thÃ´ng
                tin Ä‘ÃªÌn chuÌng tÃ´i ngay
              </Text>
              <Button
                mt={10}
                w={"full"}
                colorScheme={"purple"}
                onClick={() => router.push("/campaigns/new")}
              >
                TaÌ£o ngay
              </Button>
            </Box>
          </Flex>
          <Flex
            direction="column"
            className="border-2"
            bg={useColorModeValue("white", "gray.800")}
            boxShadow={"2xl"}
            rounded={"md"}
            overflow={"hidden"}
            m={4}
          >
            <Box
              p={6}
              flex={1}
              color={useColorModeValue("gray.800", "white")}
              align={"center"}
            >
              <FcDonate size="3rem" />
              <Text py={4} fontWeight={600} fontSize={"xl"}>
                TÃ”I LAÌ€ NHAÌ€ HAÌ‰O TÃ‚M
              </Text>
            </Box>
            <Box px={6} pb={6} mt="auto">
              <Text>
                Chá»‰ vá»›i vÃ i thao taÌc Ä‘Æ¡n giaÌ‰n, báº¡n Ä‘Ã£ gÃ³p pháº§n giÃºp Ä‘á»¡ 1 hoÃ n
                cáº£nh khÃ³ khÄƒn cÃ³ cuá»™c sá»‘ng tá»‘t Ä‘áº¹p hÆ¡n.
              </Text>
              <Button mt={10} w={"full"} colorScheme={"purple"}>
                UÌ‰ng hÃ´Ì£ ngay
              </Button>
            </Box>
          </Flex>
        </Grid>
      </SectionContainer>
      <SectionContainer id="current-campaigns">
        <Heading
          textAlign="center"
          fontSize={{ base: "3xl", sm: "4xl", md: "5xl" }}
          lineHeight={"110%"}
          color={color.PRIMARY}
        >
          CaÌc hoaÌ£t Ä‘Ã´Ì£ng Ä‘ang diÃªÌƒn ra ğŸ”¥
        </Heading>
        <Grid
          templateColumns={[
            "repeat(1, 1fr)",
            "repeat(1, 1fr)",
            "repeat(2, 1fr)",
            "repeat(3, 1fr)"
          ]}
          columnGap={4}
          rowGap={8}
          my={12}
        >
          {campaigns.map((campaign, index) => (
            <CampaignCard
              key={index}
              campaign={campaign}
              handleClick={directToDetailPage}
            />
          ))}
        </Grid>
        <Flex justify="center">
          <Button
            size="lg"
            px={6}
            variant="outline"
            colorScheme={"purple"}
            onClick={() => router.push("/campaigns")}
          >
            Xem thÃªm
          </Button>
        </Flex>
      </SectionContainer>
    </div>
  );
}
